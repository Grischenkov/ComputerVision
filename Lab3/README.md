# Лабораторная работа №3. Классификация изображений

## Задание 
Необходимо реализовать простейшую систему классификации изображений на основе сверточных нейронных сетей.
* Реализовать систему классификации согласно описанию, используя не менее трех различных архитектур нейронной сети.
* Сравнить качество работы, скорость и количество потребляемой памяти для каждой архитектуры.

Система должна загружать изображение с диска, преобразовывать в нужный для обработки моделью нейронной сети формат (тензор), выполнять предобработку, если требуется (например, изменение размера и нормирование), затем обрабатывать с помощью нейронной сети и выводить результат (номер класса, название, его вероятность для первых 5 наиболее вероятных классов).

Каждую модель необходимо протестировать на собственном наборе из не менее чем 50 изображений (можно использовать любые изображения, но не те, которые использовались для обучения), в качестве метрик использовать top-1 accuracy и top-5 accuracy.

Используемые в работе модели:
* VGG16,
* VGG19,
* ResNet-50,
* EfficientNet_B0.

## Теория
#### _VGG_
_VGG_ объединила 16-19 сверточных слоев в последовательности сверток размерностями 3x3. В этой архитектуре используются фильтры малой размерности, поскольку они, как было доказано, имеют те же рецептивные поля, что и матрицы фильтров 5x5 или 7x7. В архитектуре VGG16 в сумме 16 сверточных и полносвязных слоев, в VGG19 – соответственно 19 слоев. Также в них отказались от использования слоя с локальной нормализацией (local response normalization layer), так как при разработке было выяснено, что он не оказывает начительного влияния на результаты.

Архитектура VGG:

![Alt text](images/vgg_describe_1.png?raw=true "Архитектура сети VGG")

_(a) - VGG16, (b) - VGG19_

#### _ResNet-50_
_ResNet_ — это сокращенное название для Residual Network (дословно  — «остаточная сеть»).

Данные "проскакивают" через несколько слоёв нейронной сети и конкатенируются с данными, прошедшими преобразования. Такие пропуски позволяют эффективно распространяться по сети градиентам.

Архитектура ResNet50:

![Alt text](images/ResNet50_describe_1.png?raw=true "Архитектура сети ResNet-50")

#### _EfficientNet_B0_
_EfficientNet_ — класс новых моделей, который получился из изучения масштабирования (scaling) моделей и балансирования между собой глубины и ширины (количества каналов) сети, а также разрешения изображений в сети. Авторы статьи предлагают новый метод составного масштабирования (compound scaling method), который равномерно масштабирует глубину/ширину/разрешение с фиксированными пропорциями между ними.

Архитектура EfficientNet_B0:

![Alt text](images/EfficientNetB0_describe_1.png?raw=true "Архитектура сети EfficientNet_B0")
![Alt text](images/EfficientNetB0_describe_2.png?raw=true "Архитектура сети EfficientNet_B0")
![Alt text](images/EfficientNetB0_describe_3.png?raw=true "Архитектура сети EfficientNet_B0")

## Реализация
Для работы были использованы предобученные на датасете ImageNet модели из библиотеки Keras.

Для тестирования работы используется 50 изображений (по 5 изображений для 10 классов ImageNet).

Представленные классы: 
* bee, 
* conch, 
* hamster, 
* hare, 
* hen, 
* kite, 
* lemon, 
* scorpion, 
* tarantula, 
* zebra. 

Предобработка данных включает в себя изменений размеров изображений для соответствования с требованиями входных форм используемых сетей (cv2.resize).

## Результаты
| Модель          | Top-1 accuracy | Top-5 accuracy | Использование видеопамяти | Время работы |
| ------          | ------         | ------         | ------                    | ------       |
| VGG16           | 0.78           | 0.88           | 1.33 GB                   | 0.34 c       |
| VGG19           | 0.80           | 0.88           | 1.35 GB                   | 0.40 c       |
| ResNet-50       | 0.78           | 0.90           | 0.46 GB                   | 0.94 c       |
| EfficientNet_B0 | 0.78           | 0.88           | 0.37 GB                   | 1.32 c       |

## Выводы
В результате проделанной работы была реализована программа по анализу качества классификации изображений с использованием 4 моделей нейронных сетей: VGG16, VGG19, ResNet-50 и EfficientNet_B0. 

Метрики качества классификации для всех моделей отличаются незначительно, однако модели VGG справляются с задачей со значительным потреблением памяти, а по использованию времени выполнения EfficientNet_B0 является самой медленной.

## Список используемых источников
* https://arxiv.org/abs/1512.03385
* https://arxiv.org/abs/1409.1556
* https://arxiv.org/abs/1905.11946
* https://www.tensorflow.org/api_docs/python/tf/keras/applications
* https://deeplearning.cms.waikato.ac.nz/user-guide/class-maps/IMAGENET/